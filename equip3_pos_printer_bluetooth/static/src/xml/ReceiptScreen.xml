<?xml version="1.0" encoding="UTF-8"?>
<templates id="template" xml:space="preserve">

<t t-name="ReceiptScreen" t-inherit="point_of_sale.ReceiptScreen" t-inherit-mode="extension" owl="1">
    <xpath expr="//div[hasclass('buttons')]" position="replace">
        <!-- <div style="display: inline-flex; width: 100%; "> -->
        <div class="buttons" style="width: 100%; ">
            <t t-if="env.pos.config.pos_bluetooth_printer">
                <t t-if="env.pos.config.receipt_types_views == 'categoryReceipt' and env.pos.pos_categ_id or env.pos.config.receipt_types_views == 'labelReceipt'">
                    <div class="button print pos_bluetooth_printer-001" style="margin: inherit;margin-right:30px;max-width:unset;padding:10px 3px;" t-on-click="printReceiptAndLabel">
                        <i class="fa fa-print" style="margin-right:5px;"></i> Print Receipt and Category
                    </div>
                    <div class="button print" style="margin: inherit;margin-right:30px;max-width:unset;padding:10px 3px;" t-on-click="printReceipt">
                        <i class="fa fa-print"></i> Print Receipt
                    </div>
                    <div class="button print" style="margin: inherit;margin-right:30px;max-width:unset;padding:10px 3px;" t-on-click="printLabel">
                        <i class="fa fa-print"></i> Print Category
                    </div>
                </t> 
                <t t-else="">
                    <div class="button print pos_bluetooth_printer-002" 
                        style="margin-top: 10px; display: block; max-width: unset; padding: 10px 3px;" 
                        t-on-click="printReceipt">
                        <i class="fa fa-print"></i> Print Receipt
                    </div>
                </t>
            </t>
            <t t-else="">
                <div class="button print pos_bluetooth_printer-003" style="margin: inherit;margin-right:30px;max-width:unset;padding:10px 3px;" t-on-click="printReceipt">
                    <i class="fa fa-print"></i> Print Receipt
                </div>
            </t>
        </div>
        <!-- </div> -->
    </xpath>

    <xpath expr="//form[hasclass('send-email')]" position="after">
        <div style="margin: inherit; margin-left: 12px; max-width:unset; padding:0px;">
            <p style="margin: 0px">Print Count
                <span t-esc="state.receiptPrintedCounter" class="counter-display"></span>
            </p>
        </div>
    </xpath>

    <xpath expr="//div[hasclass('pos-receipt-container')]" position="replace">
        <t t-if="env.pos.config.pos_bluetooth_printer">
            <div class="pos-receipt-container pos_bluetooth_printer-receipt-container">
                <OrderReceipt order="currentOrder" t-ref="order-receipt" />
                <t t-if="env.pos.config.receipt_types_views == 'labelReceipt'">
                    <t t-if="currentOrder.computeChanges_product().new.length > 0">
                        <t t-foreach="currentOrder.computeChanges_product().new" t-as="label_receipt">
                        <LabelReceiptNew changes="currentOrder.computeChanges_product()" category_receipt="label_receipt" t-ref="label-receipt" />
                        </t>
                    </t>
                    <t t-if="currentOrder.computeChanges_product().cancelled.length > 0">
                        <t t-foreach="currentOrder.computeChanges_product().cancelled" t-as="label_receipt">
                        <LabelReceiptCancelled changes="currentOrder.computeChanges_product()" category_receipt="label_receipt" t-ref="label-receipt" />
                        </t>
                    </t>
                </t>
                <t t-if="env.pos.config.receipt_types_views == 'categoryReceipt' and env.pos.pos_categ_id">
                    <t t-foreach="env.pos.pos_categ_id" t-as="category_receipt" t-key="category_receipt">
                        <t t-set='count_t' t-value='0' />
                        <t t-foreach="currentOrder.computeChanges_orderlines().all" t-as="orderline">
                            <t t-if="orderline.category">
                                <t t-if="orderline.category == category_receipt">
                                    <t t-set='count_t' t-value='1' />
                                </t>
                            </t>
                        </t>
                        <t t-if="count_t">
                            <CategoryReceipt order="currentOrder" changes="currentOrder.computeChanges()" category_receipt="category_receipt" t-ref="category-receipt" />
                        </t>
                    </t>
                </t>

            </div>
        </t>
        <t t-else="">
            <div class="pos-receipt-container pos_bluetooth_printer-receipt-container">
                <OrderReceipt order="currentOrder" t-ref="order-receipt" />
            </div>
        </t>
    </xpath>
</t>

<t t-name="OrderReceipt" t-inherit="point_of_sale.OrderReceipt" t-inherit-mode="extension" owl="1">
    <xpath expr="//div[hasclass('pos-receipt-order-data')]" position="after">
        <t t-if="env.pos.config.pos_bluetooth_printer">
        <br />
        <br />
        </t>
    </xpath>
</t>

</templates>
